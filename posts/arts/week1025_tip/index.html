<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content="ARTS - Tip 补12.24 MySQL报错 Packet for query is too large 问题出现 今日碰到了一个mysql报错如下：
com.mysql.jdbc.PacketTooBigException: Packet for query is too large (4281662 &amp;gt; 4194304). You can change this value on the server by setting the max_allowed_packet&amp;#39; variable. 这句话说查询包太大了，这里有一个参数叫 max_allowed_packet，查询资料发现是MySQL设置的最大查询发送包大下，现在看来是超过了。查找相应的SQL语句，确实传送了大量的数据作为参数，然后就优化了SQL，避开这种使用方式。
max_allowed_packet 这个参数是什么呢?
查询MySQL文档，发现这个是系统变量，在MySQL版本&amp;lt;=8.0.2 时候默认是4194304，也就是4M，大于这个版本是默认64M.
The maximum size of one packet or any generated/intermediate string, or any parameter sent by the mysql_stmt_send_long_data() C API function. The default is 64MB.
The packet message buffer is initialized to net_buffer_length bytes, but can grow up to max_allowed_packet bytes when needed."><meta name=keywords content=",arts"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=/posts/arts/week1025_tip/><title>Week1025_tip :: Hello Friend — A coder's Homepage</title><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css integrity="sha512-Cv93isQdFwaKBV+Z4X8kaVBYWHST58Xb/jVOcV9aRsGSArZsgAnFIhMpDoMDcFNoUtday1hdjn0nGp3+KZyyFw==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/main.2a064c455b0ecbd6b1481b3bf9df2441e95838691022f40a5338c2cb1244f075.css integrity="sha256-KgZMRVsOy9axSBs7+d8kQelYOGkQIvQKUzjCyxJE8HU="><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="Week1025_tip"><meta itemprop=description content="ARTS - Tip 补12.24 MySQL报错 Packet for query is too large 问题出现 今日碰到了一个mysql报错如下：
com.mysql.jdbc.PacketTooBigException: Packet for query is too large (4281662 > 4194304). You can change this value on the server by setting the max_allowed_packet' variable. 这句话说查询包太大了，这里有一个参数叫 max_allowed_packet，查询资料发现是MySQL设置的最大查询发送包大下，现在看来是超过了。查找相应的SQL语句，确实传送了大量的数据作为参数，然后就优化了SQL，避开这种使用方式。
max_allowed_packet 这个参数是什么呢?
查询MySQL文档，发现这个是系统变量，在MySQL版本<=8.0.2 时候默认是4194304，也就是4M，大于这个版本是默认64M.
The maximum size of one packet or any generated/intermediate string, or any parameter sent by the mysql_stmt_send_long_data() C API function. The default is 64MB.
The packet message buffer is initialized to net_buffer_length bytes, but can grow up to max_allowed_packet bytes when needed."><meta itemprop=datePublished content="2023-03-31T15:45:41+00:00"><meta itemprop=dateModified content="2023-03-31T15:45:41+00:00"><meta itemprop=wordCount content="303"><meta itemprop=keywords content="arts,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Week1025_tip"><meta name=twitter:description content="ARTS - Tip 补12.24 MySQL报错 Packet for query is too large 问题出现 今日碰到了一个mysql报错如下：
com.mysql.jdbc.PacketTooBigException: Packet for query is too large (4281662 > 4194304). You can change this value on the server by setting the max_allowed_packet' variable. 这句话说查询包太大了，这里有一个参数叫 max_allowed_packet，查询资料发现是MySQL设置的最大查询发送包大下，现在看来是超过了。查找相应的SQL语句，确实传送了大量的数据作为参数，然后就优化了SQL，避开这种使用方式。
max_allowed_packet 这个参数是什么呢?
查询MySQL文档，发现这个是系统变量，在MySQL版本<=8.0.2 时候默认是4194304，也就是4M，大于这个版本是默认64M.
The maximum size of one packet or any generated/intermediate string, or any parameter sent by the mysql_stmt_send_long_data() C API function. The default is 64MB.
The packet message buffer is initialized to net_buffer_length bytes, but can grow up to max_allowed_packet bytes when needed."><meta property="og:title" content="Week1025_tip"><meta property="og:description" content="ARTS - Tip 补12.24 MySQL报错 Packet for query is too large 问题出现 今日碰到了一个mysql报错如下：
com.mysql.jdbc.PacketTooBigException: Packet for query is too large (4281662 > 4194304). You can change this value on the server by setting the max_allowed_packet' variable. 这句话说查询包太大了，这里有一个参数叫 max_allowed_packet，查询资料发现是MySQL设置的最大查询发送包大下，现在看来是超过了。查找相应的SQL语句，确实传送了大量的数据作为参数，然后就优化了SQL，避开这种使用方式。
max_allowed_packet 这个参数是什么呢?
查询MySQL文档，发现这个是系统变量，在MySQL版本<=8.0.2 时候默认是4194304，也就是4M，大于这个版本是默认64M.
The maximum size of one packet or any generated/intermediate string, or any parameter sent by the mysql_stmt_send_long_data() C API function. The default is 64MB.
The packet message buffer is initialized to net_buffer_length bytes, but can grow up to max_allowed_packet bytes when needed."><meta property="og:type" content="article"><meta property="og:url" content="/posts/arts/week1025_tip/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-31T15:45:41+00:00"><meta property="article:modified_time" content="2023-03-31T15:45:41+00:00"><meta property="og:site_name" content="Hello Friend "><meta property="article:published_time" content="2023-03-31 15:45:41 +0000 UTC"></head><body><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>hello world...</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=/about>About</a></li><li><a href=/posts>Blog</a></li><li><a href=/categorys>Category</a></li><li><a href=/series>Series</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>2 minutes</p></div><article><h1 class=post-title><a href=/posts/arts/week1025_tip/>Week1025_tip</a></h1><div class=post-content><h2 id=arts---tip-补1224>ARTS - Tip 补12.24</h2><h2 id=mysql报错-packet-for-query-is-too-large>MySQL报错 Packet for query is too large</h2><h3 id=问题出现>问题出现</h3><p>今日碰到了一个mysql报错如下：</p><pre tabindex=0><code>com.mysql.jdbc.PacketTooBigException: Packet for query is too large (4281662 &gt; 4194304). You can change this value on the server by setting the max_allowed_packet&#39; variable.
</code></pre><p>这句话说查询包太大了，这里有一个参数叫 <code>max_allowed_packet</code>，查询资料发现是MySQL设置的最大查询发送包大下，现在看来是超过了。查找相应的SQL语句，确实传送了大量的数据作为参数，然后就优化了SQL，避开这种使用方式。</p><h3 id=max_allowed_packet>max_allowed_packet</h3><p>这个参数是什么呢?</p><p>查询MySQL文档，发现这个是系统变量，在MySQL版本&lt;=8.0.2 时候默认是4194304，也就是4M，大于这个版本是默认64M.</p><blockquote><p>The maximum size of one packet or any generated/intermediate string, or any parameter sent by the mysql_stmt_send_long_data() C API function. The default is 64MB.</p></blockquote><blockquote><p>The packet message buffer is initialized to net_buffer_length bytes, but can grow up to max_allowed_packet bytes when needed. This value by default is small, to catch large (possibly incorrect) packets.</p></blockquote><p>这里提到了一个 net_buffer_length , 这个参数默认是 16384, 也就是16K. 在不够用时候会增长到max_allowed_packet 大小。</p><blockquote><p>You must increase this value if you are using large BLOB columns or long strings. It should be as big as the largest BLOB you want to use. The protocol limit for max_allowed_packet is 1GB. The value should be a multiple of 1024; nonmultiples are rounded down to the nearest multiple.</p></blockquote><p>你在使用大的 BLOB列或长的strings 时候，应该变大，为1024的倍数，最大为1G。</p><blockquote><p>When you change the message buffer size by changing the value of the max_allowed_packet variable, you should also change the buffer size on the client side if your client program permits it. The default max_allowed_packet value built in to the client library is 1GB, but individual client programs might override this. For example, mysql and mysqldump have defaults of 16MB and 24MB, respectively. They also enable you to change the client-side value by setting max_allowed_packet on the command line or in an option file.</p></blockquote><p>当在服务端改变这个大小时候，也要在客户端跟着改变。</p><blockquote><p>The session value of this variable is read only. The client can receive up to as many bytes as the session value. However, the server will not send to the client more bytes than the current global max_allowed_packet value. (The global value could be less than the session value if the global value is changed after the client connects.)</p></blockquote><p>客户端连接后如果全局变量被修改，那么实际的服务端传输大小会小于客户端设置的大小。</p></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=/tags/arts/>arts</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>303 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2023-03-31 15:45</p></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=/posts/arts/week1025_share/><span class=button__icon>←</span>
<span class=button__text>Week1025_share</span></a></span>
<span class="button next"><a href=/posts/arts/week1026_algorithm/><span class=button__text>Week1026_algorithm</span>
<span class=button__icon>→</span></a></span></div></div></main></div><footer class=footer></footer></div><script type=text/javascript src=/bundle.min.c90b8161416b87c69a8e02683b54ddd6edb90aea699648bf655e6cbc45b419b8e465d196e715772463dba35a6faf5decb2eb247480d38680484d54645b434570.js integrity="sha512-yQuBYUFrh8aajgJoO1Td1u25Cupplki/ZV5svEW0GbjkZdGW5xV3JGPbo1pvr13ssuskdIDThoBITVRkW0NFcA=="></script></body></html>