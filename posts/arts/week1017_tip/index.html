<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content="ARTS - Tip 谈谈MySQL慢查询 什么是慢查询 MySQL的慢查询是MySQL提供的一种记录查询慢的SQL的工具。方便做系统优化。
开启慢查询日志 默认情况下是关闭的，
mysql&amp;gt; show variables like &amp;#39;slow_query%&amp;#39;; +---------------------+-------------------------------------+ | Variable_name | Value | +---------------------+-------------------------------------+ | slow_query_log | OFF | | slow_query_log_file | /usr/local/var/mysql/bogon-slow.log | +---------------------+-------------------------------------+ 2 rows in set (0.01 sec) ysql&amp;gt; show variables like &amp;#39;long_query_time&amp;#39;; +-----------------+-----------+ | Variable_name | Value | +-----------------+-----------+ | long_query_time | 10.000000 | +-----------------+-----------+ 1 row in set (0.00 sec) 设置方法
全局变量设置
#将 slow_query_log 全局变量设置为“ON”状态 mysql&amp;gt; set global slow_query_log=&amp;#39;ON&amp;#39;; #设置慢查询日志存放的位置 mysql&amp;gt; set global slow_query_log_file=&amp;#39;/usr/local/mysql/data/slow."><meta name=keywords content=",arts"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=/posts/arts/week1017_tip/><title>Week1017_tip :: Hello Friend — A coder's Homepage</title><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css integrity="sha512-Cv93isQdFwaKBV+Z4X8kaVBYWHST58Xb/jVOcV9aRsGSArZsgAnFIhMpDoMDcFNoUtday1hdjn0nGp3+KZyyFw==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/main.2a064c455b0ecbd6b1481b3bf9df2441e95838691022f40a5338c2cb1244f075.css integrity="sha256-KgZMRVsOy9axSBs7+d8kQelYOGkQIvQKUzjCyxJE8HU="><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="Week1017_tip"><meta itemprop=description content="ARTS - Tip 谈谈MySQL慢查询 什么是慢查询 MySQL的慢查询是MySQL提供的一种记录查询慢的SQL的工具。方便做系统优化。
开启慢查询日志 默认情况下是关闭的，
mysql> show variables like 'slow_query%'; +---------------------+-------------------------------------+ | Variable_name | Value | +---------------------+-------------------------------------+ | slow_query_log | OFF | | slow_query_log_file | /usr/local/var/mysql/bogon-slow.log | +---------------------+-------------------------------------+ 2 rows in set (0.01 sec) ysql> show variables like 'long_query_time'; +-----------------+-----------+ | Variable_name | Value | +-----------------+-----------+ | long_query_time | 10.000000 | +-----------------+-----------+ 1 row in set (0.00 sec) 设置方法
全局变量设置
#将 slow_query_log 全局变量设置为“ON”状态 mysql> set global slow_query_log='ON'; #设置慢查询日志存放的位置 mysql> set global slow_query_log_file='/usr/local/mysql/data/slow."><meta itemprop=datePublished content="2023-03-31T15:45:37+00:00"><meta itemprop=dateModified content="2023-03-31T15:45:37+00:00"><meta itemprop=wordCount content="174"><meta itemprop=keywords content="arts,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Week1017_tip"><meta name=twitter:description content="ARTS - Tip 谈谈MySQL慢查询 什么是慢查询 MySQL的慢查询是MySQL提供的一种记录查询慢的SQL的工具。方便做系统优化。
开启慢查询日志 默认情况下是关闭的，
mysql> show variables like 'slow_query%'; +---------------------+-------------------------------------+ | Variable_name | Value | +---------------------+-------------------------------------+ | slow_query_log | OFF | | slow_query_log_file | /usr/local/var/mysql/bogon-slow.log | +---------------------+-------------------------------------+ 2 rows in set (0.01 sec) ysql> show variables like 'long_query_time'; +-----------------+-----------+ | Variable_name | Value | +-----------------+-----------+ | long_query_time | 10.000000 | +-----------------+-----------+ 1 row in set (0.00 sec) 设置方法
全局变量设置
#将 slow_query_log 全局变量设置为“ON”状态 mysql> set global slow_query_log='ON'; #设置慢查询日志存放的位置 mysql> set global slow_query_log_file='/usr/local/mysql/data/slow."><meta property="og:title" content="Week1017_tip"><meta property="og:description" content="ARTS - Tip 谈谈MySQL慢查询 什么是慢查询 MySQL的慢查询是MySQL提供的一种记录查询慢的SQL的工具。方便做系统优化。
开启慢查询日志 默认情况下是关闭的，
mysql> show variables like 'slow_query%'; +---------------------+-------------------------------------+ | Variable_name | Value | +---------------------+-------------------------------------+ | slow_query_log | OFF | | slow_query_log_file | /usr/local/var/mysql/bogon-slow.log | +---------------------+-------------------------------------+ 2 rows in set (0.01 sec) ysql> show variables like 'long_query_time'; +-----------------+-----------+ | Variable_name | Value | +-----------------+-----------+ | long_query_time | 10.000000 | +-----------------+-----------+ 1 row in set (0.00 sec) 设置方法
全局变量设置
#将 slow_query_log 全局变量设置为“ON”状态 mysql> set global slow_query_log='ON'; #设置慢查询日志存放的位置 mysql> set global slow_query_log_file='/usr/local/mysql/data/slow."><meta property="og:type" content="article"><meta property="og:url" content="/posts/arts/week1017_tip/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-31T15:45:37+00:00"><meta property="article:modified_time" content="2023-03-31T15:45:37+00:00"><meta property="og:site_name" content="Hello Friend "><meta property="article:published_time" content="2023-03-31 15:45:37 +0000 UTC"></head><body><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>hello world...</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=/about>About</a></li><li><a href=/posts>Blog</a></li><li><a href=/categorys>Category</a></li><li><a href=/series>Series</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>One minute</p></div><article><h1 class=post-title><a href=/posts/arts/week1017_tip/>Week1017_tip</a></h1><div class=post-content><h2 id=arts---tip>ARTS - Tip</h2><h2 id=谈谈mysql慢查询>谈谈MySQL慢查询</h2><h3 id=什么是慢查询>什么是慢查询</h3><p>MySQL的慢查询是MySQL提供的一种记录查询慢的SQL的工具。方便做系统优化。</p><h3 id=开启慢查询日志>开启慢查询日志</h3><p>默认情况下是关闭的，</p><pre tabindex=0><code>
mysql&gt; show variables like &#39;slow_query%&#39;;
+---------------------+-------------------------------------+
| Variable_name       | Value                               |
+---------------------+-------------------------------------+
| slow_query_log      | OFF                                 |
| slow_query_log_file | /usr/local/var/mysql/bogon-slow.log |
+---------------------+-------------------------------------+
2 rows in set (0.01 sec)


ysql&gt; show variables like &#39;long_query_time&#39;;
+-----------------+-----------+
| Variable_name   | Value     |
+-----------------+-----------+
| long_query_time | 10.000000 |
+-----------------+-----------+
1 row in set (0.00 sec)
</code></pre><p>设置方法</p><p>全局变量设置</p><pre tabindex=0><code>#将 slow_query_log 全局变量设置为“ON”状态

mysql&gt; set global slow_query_log=&#39;ON&#39;; 

#设置慢查询日志存放的位置

mysql&gt; set global slow_query_log_file=&#39;/usr/local/mysql/data/slow.log&#39;;

#查询超过1秒就记录

mysql&gt; set global long_query_time=1;
</code></pre><h3 id=explain-分析>explain 分析</h3><p>设置慢查询日志后，就会在日志里记录慢查询SQL， 然后使用 explain 分析。</p><pre tabindex=0><code>mysql&gt; explain select * from Employee where AGE &gt; 30;
+----+-------------+----------+------------+------+---------------+------+---------+------+------+----------+-------------+
| id | select_type | table    | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |
+----+-------------+----------+------------+------+---------------+------+---------+------+------+----------+-------------+
|  1 | SIMPLE      | Employee | NULL       | ALL  | NULL          | NULL | NULL    | NULL |    5 |    33.33 | Using where |
+----+-------------+----------+------------+------+---------------+------+---------+------+------+----------+-------------+
</code></pre><table><thead><tr><th>列名</th><th>说明</th></tr></thead><tbody><tr><td>id</td><td>执行编号，标识select所属的行。如果在语句中没子查询或关联查询，只有唯一的select，每行都将显示1。否则，内层的select语句一般会顺序编号，对应于其在原始语句中的位置</td></tr><tr><td>select_type</td><td>显示本行是简单或复杂select。如果查询有任何复杂的子查询，则最外层标记为PRIMARY（DERIVED、UNION、UNION RESUlT）</td></tr><tr><td>table</td><td>访问引用哪个表（引用某个查询，如“derived3”）</td></tr><tr><td>type</td><td>数据访问/读取操作类型（ALL、index、range、ref、eq_ref、const/system、NULL）</td></tr><tr><td>possible_keys</td><td>揭示哪一些索引可能有利于高效的查找</td></tr><tr><td>key</td><td>显示mysql决定采用哪个索引来优化查询</td></tr><tr><td>key_len</td><td>显示mysql在索引里使用的字节数</td></tr><tr><td>ref</td><td>显示了之前的表在key列记录的索引中查找值所用的列或常量</td></tr><tr><td>rows</td><td>为了找到所需的行而需要读取的行数，估算值，不精确。通过把所有rows列值相乘，可粗略估算整个查询会检查的行数</td></tr><tr><td>Extra</td><td>额外信息，如using index、filesort等</td></tr></tbody></table></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=/tags/arts/>arts</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>174 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2023-03-31 15:45</p></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=/posts/arts/week1017_share/><span class=button__icon>←</span>
<span class=button__text>Week1017_share</span></a></span>
<span class="button next"><a href=/posts/arts/week1013_review/><span class=button__text>Week1013_review</span>
<span class=button__icon>→</span></a></span></div></div></main></div><footer class=footer></footer></div><script type=text/javascript src=/bundle.min.c90b8161416b87c69a8e02683b54ddd6edb90aea699648bf655e6cbc45b419b8e465d196e715772463dba35a6faf5decb2eb247480d38680484d54645b434570.js integrity="sha512-yQuBYUFrh8aajgJoO1Td1u25Cupplki/ZV5svEW0GbjkZdGW5xV3JGPbo1pvr13ssuskdIDThoBITVRkW0NFcA=="></script></body></html>